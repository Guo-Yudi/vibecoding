<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>AI Travel Planner</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main-style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/form-styles.css') }}">
    <script type="text/javascript"
        src="https://api.map.baidu.com/api?v=1.0&type=webgl&ak=l8IZzVxMX1Pc882f2NEcZI6AsnlYysZl"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/map_init.js') }}"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/aiwindow-style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/1.9.1/showdown.min.js"></script>
</head>

<body>
    <div id="header">
        <h1>AI Travel Planner</h1>
        <div id="auth-section">
            <button id="login-btn" class="btn-auth">登录</button>
            <button id="signup-btn" class="btn-auth">注册</button>
        </div>
        <div id="user-section" style="display: none;">
            <span id="user-email-display"></span>
            <button id="my-plans-btn" class="btn-auth">我的计划</button>
            <button id="logout-btn" class="btn-auth">登出</button>
        </div>
    </div>
    <div id="main-content">
        <div id="left-panel">
            <h2>功能列表</h2>
            <div class="control-group">
                <button id="locate-btn" class="btn">定位到当前位置</button>
                <button id="mic-btn" class="btn" type="button">语音输入</button>
            </div>
            <section class="card">
                <form class="form" id="plan-form" method="POST" action="/generate">
                    <div class="form-grid">
                        <div class="field">
                            <label for="city">目的地</label>
                            <input id="city" name="city" type="text" placeholder="南京" required />
                        </div>

                        <div class="field">
                            <label for="days">天数</label>
                            <input id="days" name="days" type="number" min="1" max="21" placeholder="3" />
                        </div>

                        <div class="field">
                            <label for="budget">预算</label>
                            <input id="budget" name="budget" type="text" placeholder="1000元" />
                        </div>

                        <div class="field">
                            <label for="people">人数</label>
                            <input id="people" name="people" type="number" min="1" max="12" placeholder="1" />
                        </div>

                        <div class="field">
                            <label for="dietary">饮食偏好（可选）</label>
                            <input id="dietary" name="dietary" type="text" placeholder="酸，甜，咸，苦，辣" />
                        </div>

                        <div class="field field-full">
                            <label for="interests">兴趣爱好（可选）</label>
                            <input id="interests" name="interests" type="text" />
                        </div>
                    </div>

                    <button class="btn" type="submit">生成</button>
                </form>
            </section>
        </div>
        <div id="container">
        </div>
        <div id="map-search-bar">
            <input id="map-search-input" type="text" placeholder="在地图上搜索...">
            <div id="search-suggestions"></div> <!-- 新增的建议列表容器 -->
            <button id="map-search-button">搜索</button>
        </div>
    </div>

    <!-- Auth Modal -->
    <div id="auth-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <span class="close-btn auth-close">&times;</span>
            <h2 id="auth-title">登录</h2>
            <form id="auth-form">
                <div id="username-group" style="display: none;">
                    <label for="auth-username">用户名</label>
                    <input type="text" id="auth-username" name="username" placeholder="用户名">
                </div>
                <div>
                    <label for="auth-email">邮箱</label>
                    <input type="email" id="auth-email" name="email" placeholder="邮箱" required>
                </div>
                <div>
                    <label for="auth-password">密码</label>
                    <input type="password" id="auth-password" name="password" placeholder="密码" required>
                </div>
                <button type="submit" id="auth-submit-btn" class="btn">提交</button>
            </form>
        </div>
    </div>

    <!-- Plans Modal -->
    <div id="plans-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <span class="close-btn plans-close">&times;</span>
            <h2>我的计划</h2>
            <div id="plans-list"></div>
        </div>
    </div>

    <!-- 结果弹窗 -->
    <div id="result-modal" class="modal-overlay">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <div id="result-text"></div>
            <button id="save-plan-btn" class="btn" style="display: none;">保存计划</button>
        </div>
    </div>


    <!-- Speech Input Modal -->
    <div id="speech-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h2>请说出您的旅行计划</h2>
            <div id="speech-feedback" class="speech-feedback-container" style="display: block;">
                <p id="speech-text" class="speech-text">正在等待语音...</p>
            </div>
            <button id="finish-speech-btn" class="btn">完成</button>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/speech.js') }}"></script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    <script src="{{ url_for('static', filename='js/auth.js') }}"></script>
    <script src="{{ url_for('static', filename='js/plan.js') }}"></script>
    <script src="{{ url_for('static', filename='js/ui.js') }}"></script>
</body>

</html>